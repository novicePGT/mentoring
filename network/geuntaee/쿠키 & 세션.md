쿠키와 세션은 HTTP 프로토콜의 특징이자 약점을 보안하기 위해서 사용한다.

- Connectionless : 비연결지향
클라이언트가 서버에 요청했을 때, 그 요청에 맞는 응답을 보낸 후 연결을 끊는 처리방식.

- Stateless : 상태정보 유지 X
클라이언트의 상태정보를 가지지 않는 서버 처리 방식으로 접속을 끊는 순간 클라이언트와 서버의 통신은 끝나고 상태 정보는 유지되지 않는다.

- Connectionless & Stateless 의 장점
통신을 유지하고 있을 때, 낭비되는 리소스를 줄인다.

- Connectionless & Stateless 의 단점
통신을 할 때마다 계속 내가 누구인지 인증을 해야한다.

위의 문제점을 해결하기 위해 쿠키와 세션을 사용해서 해결한다.

## 쿠키( Cookie )
- 클라이언트에 저장되는 키와 값이 들어있는 작은 데이터 파일.
- 이름, 값 만료 날짜( 쿠키 저장기간 ), 경로 정보가 들어있다.
- 일정 시간동안 데이터를 저장할 수 있어서 로그인 상태를 유지한다.
- 클라이언트의 상태 정보를 본인 하드 디스크에 저장하였다가 필요할 때 참조, 재사용한다.

## 쿠키 동작 순서
1. 클라이언트 요청 ( 사용자가 웹사이트 접근 )
2. 웹 서버는 쿠키 생성
3. 생성한 쿠키에 정보를 담아 HTTP화면을 돌려줄 때 같이 클라이언트에게 넘긴다.
4. 넘겨받은 쿠키는 클라이언트가 가지고 있다가 다시 서버에 요청 시 쿠키를 함께 전송.
5. 동일한 사이트에 재방문 시 클라이언트에 해당 쿠키가 있다면 요청페이지와 함께 쿠키 전송.

-> 자동 로그인, 쇼핑몰 장바구니, 오늘 이 창 다시보지 않기 등...

## 쿠키 특징
- 클라이언트에 총 300개까지 쿠키를 저장할 수 있다.
- 하나의 도메인 당 20개의 값만 가질 수 있다.
- 하나의 쿠키 값은 4MB까지 저장 가능하다.

## 세션
사용자가 웹 브라우저를 통해 웹서버에 접속한 시점으로부터 웹 브라우저를 종료하여 연결을 끝내는 시점까지 같은 사용자로부터 오는 일련의 요청을 하나의 상태로 보고, 그 상태를 일정하게 유지하는 기술.
- 결과적으로 방문자가 웹 서버에 접속해 있는 상태를 하나의 단위로 보고 그것을 **세션** 이라고 한다.

## 세션 동작 순서
1. 클라이언트 요청( 사용자가 웹사이트 접근 )
2. 서버는 클라이언트의 Request-Header필드인 Cookie를 확인하여 클라이언트가 해당 세션 ID를 보냈는지 확인.
3. 세션 ID가 존재하지 않는다면 서버는 세션 ID를 생성해 클라이언트에게 전송.
4. 서버에서 클라이언트로 준 세션 ID를 쿠키를 사용해 서버에 저장.
5. 클라이언트는 재접속 시 이 쿠키를 사용하여 세션 ID값을 서버에 전달한다.

-> 화면 이동해도 로그인이 풀리지 않고 유지, 관리자/사용자 여부 판단 등...

## 세션 특징
- 웹서버에 웹 컨테이너의 상태를 유지하기 위한 정보를 저장
- 브라우저를 닫거나 서버에서 세션을 삭제했을 때 삭제되어 쿠키보다 보안성이 좋다.
- 각 클라이언트의 고유 세션 ID를 부여한다.
- 사용자가 많아질수록 서버 메모리를 많이 차지하게되어 서버 과부하를 줄 수 있다.


## 쿠키 VS 세션
![](https://velog.velcdn.com/images/dymnam/post/d3f69f8c-ff63-4440-ac3f-4a8d75973879/image.png)

## 결론 !
세션이 쿠키에 비해 보안이 높지만 쿠키를 사용하는 이유는 세션은 서버에 저장되어 서버 자원을 사용하기 때문에 사용자가 많을수록 소모되는 자원이 크다.
이러한 자원관리 속에서 쿠키와 세션을 적절히 병행해 사용하면 서버의 자원 낭비를 줄이고 웹 사이트의 속도를 높일 수 있다.
